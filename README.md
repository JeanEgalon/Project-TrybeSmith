# Boas vindas ao meu reposit√≥rio do projeto Trybesmith!

<details>
  <summary><strong>üë®‚Äçüíª O que foi desenvolvido?</strong></summary><br />

  Para este projeto, criei uma loja de itens medievais, no formato de uma _API_, utilizando _Typescript_.
  
  Onde desenvolvi todas as camadas da aplica√ß√£o (_Models_, _Service_ e _Controllers_) em seu c√≥digo e, por meio dessa aplica√ß√£o, ser√° poss√≠vel realizar as opera√ß√µes b√°sicas que se pode fazer em um determinado banco de dados:
  Cria√ß√£o, Leitura, Atualiza√ß√£o e Exclus√£o (ou `CRUD`, - _Create, Read, Update_ e _Delete_).

  Criei alguns _endpoints_ que ir√£o ler e escrever no banco de dados, utilizando o **MySQL**.
</details>

<details>
  <summary><strong>Passo a passo de instala√ß√£o</strong></summary><br />

  1. Clone o reposit√≥rio

  - `git clone git@github.com:JeanEgalon/Project-TrybeSmith.git`.
  
  2. Entre na pasta do reposit√≥rio que voc√™ acabou de clonar:

  3. Instale as depend√™ncias

  - `npm install`
</details>

<details>
  <summary><strong>ü™ë Tabelas</strong></summary><br />

  O banco ter√° tr√™s tabelas: pessoas usu√°rias, produtos e pedidos.

  ```sql
  DROP SCHEMA IF EXISTS Trybesmith;
  CREATE SCHEMA Trybesmith;

  CREATE TABLE Trybesmith.Users (
    id INTEGER AUTO_INCREMENT PRIMARY KEY NOT NULL,
    username TEXT NOT NULL,
    classe TEXT NOT NULL,
    level INTEGER NOT NULL,
    password TEXT NOT NULL
  );

  CREATE TABLE Trybesmith.Orders (
    id INTEGER AUTO_INCREMENT PRIMARY KEY NOT NULL,
    userId INTEGER,
    FOREIGN KEY (userId) REFERENCES Trybesmith.Users (id)
  );

  CREATE TABLE Trybesmith.Products (
    id INTEGER AUTO_INCREMENT PRIMARY KEY NOT NULL,
    name TEXT NOT NULL,
    amount TEXT NOT NULL,
    orderId INTEGER,
    FOREIGN KEY (orderId) REFERENCES Trybesmith.Orders (id)
  );
  ```

  O arquivo `Trybesmith.sql` cont√©m as _queries_ que criam e populam o banco como o teste faz, e os testes **restauram** o banco de dados ap√≥s sua execu√ß√£o.

</details>


<details>
  <summary><strong>Requisitos</strong></summary><br />

## 1 - Crie um endpoint para o cadastro de produtos

- O endpoint deve ser acess√≠vel atrav√©s do caminho (`/products`);

- Os produtos enviados devem ser salvos na tabela `Products` do banco de dados;

- O endpoint deve receber a seguinte estrutura:
```json
  {
    "name": "Espada longa",
    "amount": "30 pe√ßas de ouro"
  }
```

## 2 - Crie um endpoint para a listagem de produtos

- O endpoint deve ser acess√≠vel atrav√©s do caminho (`/products`);

---

## 3 - Crie um endpoint para o cadastro de pessoas usu√°rias

- O endpoint deve ser acess√≠vel atrav√©s do caminho (`/users`);

- As informa√ß√µes de pessoas usu√°rias cadastradas devem ser salvas na tabela `Users` do banco de dados;

- O endpoint deve receber a seguinte estrutura:
```json
{ 
  "username": "MAX",
  "classe": "swordsman",
  "level": 10,
  "password": "SavingPeople"
}
```

- O retorno deve ser o token da pessoa cadastrada

## 4 - Crie um endpoint para listar todos os pedidos

- O endpoint deve ser acess√≠vel atrav√©s do caminho (`/orders`).
- Essa rota deve retornar todos os pedidos e os `id`s dos produtos associados a estes.


## 5 - Crie um endpoint para o login de pessoas usu√°rias

- O endpoint deve ser acess√≠vel atrav√©s do caminho (`/login`).

- A rota deve receber os campos `username` e `password`, e esses campos devem ser validados no banco de dados.

- Um token `JWT` deve ser gerado e retornado caso haja sucesso no _login_. No seu _payload_ deve estar presente o _id_ e _username_.

- O endpoint deve receber a seguinte estrutura:
```json
  {
    "username": "string",
    "password": "string"
  }
```

## Requisitos B√¥nus

## 6 - Crie as valida√ß√µes dos produtos

- Vamos realizar as valida√ß√µes referentes a cria√ß√£o do endpont do requisito 1?

- Neste requisito de valida√ß√£o, n√£o √© necess√°rio conectar com o banco de dados

<details close>

  <summary>As seguintes valida√ß√µes dever√£o ser realizadas:</summary>

  <br>

  > üëâ Para name
  - **[Ser√° validado que o campo "name" √© obrigat√≥rio]**
    - Se o campo "name" n√£o for informado, o resultado retornado dever√° ser um  _status http_ `400` e
    ```json
      { "message": "\"name\" is required" }
    ```

  - **[Ser√° validado que o campo "name" tem o tipo string]**
    - Se o campo "name" n√£o for do tipo `string`, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"name\" must be a string" }
    ```

  - **[Ser√° validado que o campo "name" √© uma string com mais de 2 caracteres]**
    - Se o campo "name" n√£o for uma string com mais de 2 caracteres, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"name\" length must be at least 3 characters long" }
    ```

  <br>

  > üëâ Para amount
  - **[Ser√° validado que o campo "amount" √© obrigat√≥rio]**
    - Se o campo "amount" n√£o for informado, o resultado retornado dever√° ser um _status http_ `400` e
    ```json
      { "message": "\"amount\" is required" }
    ```

  - **[Ser√° validado que o campo "amount" tem o tipo string]**
    - Se o campo "amount" n√£o for do tipo `string`, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"amount\" must be a string" }
    ```

  - **[Ser√° validado que o campo "amount" √© uma string com mais de 2 caracteres]**
    - Se o campo "amount" n√£o for uma string com mais de 2 caracteres, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"amount\" length must be at least 3 characters long" }
    ```

  <br>

</details>


---

## 7 - Crie as valida√ß√µes para as pessoas usu√°rias

- Vamos realizar as valida√ß√µes referentes a cria√ß√£o do endpont do requisito 3?

- Neste requisito de valida√ß√£o, n√£o √© necess√°rio conectar com o banco de dados

<details close>
  <summary>As seguintes valida√ß√µes dever√£o ser realizadas:</summary>

  <br>

  > üëâ Para username
  - **[Ser√° validado que o campo "username" √© obrigat√≥rio]**
    - Se a requisi√ß√£o n√£o tiver o campo "username", o resultado retornado dever√° ser um _status http_ `400` e
    ```json
      { "message": "\"username\" is required" }
    ```

  - **[Ser√° validado que o campo "username" tem o tipo string]**
    - Se o campo "username" n√£o for do tipo `string`, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"username\" must be a string" }
    ```

  - **[Ser√° validado que o campo "username" √© uma string com mais de 2 caracteres]**
    - Se o campo "username" n√£o for do tipo `string` com mais de 2 caracteres, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"username\" length must be at least 3 characters long" }
    ```

  <br>

  > üëâ Para classe
  - **[Ser√° validado que o campo "classe" √© obrigat√≥rio]**
    - Se a requisi√ß√£o n√£o tiver o campo "classe", o resultado retornado dever√° ser um _status http_ `400` e
    ```json
      { "message": "\"classe\" is required" }
    ```

  - **[Ser√° validado que o campo "classe" tem o tipo string]**
    - Se o campo "classe" n√£o for do tipo `string`, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"classe\" must be a string" }
    ```

  - **[Ser√° validado que o campo "classe" √© uma string com mais de 2 caracteres]**
    - Se o campo "classe" n√£o for do tipo `string` com mais de 2 caracteres, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"classe\" length must be at least 3 characters long" }
    ```

  <br>

  > üëâ Para level
  - **[Ser√° validado que o campo "level" √© obrigat√≥rio]**
    - Se a pessoa usu√°ria n√£o tiver o campo "level", o resultado retornado dever√° ser um _status http_ `400` e
    ```json
      { "message": "\"level\" is required" }
    ```

  - **[Ser√° validado que o campo "level" tem o tipo number]**
    - Se o campo "level" n√£o for do tipo `number`, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"level\" must be a number" }
    ```

  - **[Ser√° validado que o campo "level" deve ser um n√∫mero maior que 0]**
    - Se o campo "level" n√£o for do tipo `number` maior que 0, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"level\" must be greater than or equal to 1" }
    ```

  <br>

  > üëâ Para password
  - **[Ser√° validado que o campo "password" √© obrigat√≥rio]**
    - Se a requisi√ß√£o n√£o tiver o campo "password", o resultado retornado dever√° ser um _status http_ `400` e
    ```json
      { "message": "\"password\" is required" }
    ```

  - **[Ser√° validado que o campo "password" tem o tipo string]**
    - Se o campo "password" n√£o for do tipo `string`, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"password\" must be a string" }
    ```

  - **[Ser√° validado que o campo "password" √© uma string com 8 ou mais caracteres]**
    - Se o campo "password" n√£o for do tipo `string` com mais de 8 caracteres, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"password\" length must be at least 8 characters long" }
    ```

  <br>


</details>

---

## 8 - Crie um endpoint para o cadastro de um pedido

- O endpoint deve ser acess√≠vel atrav√©s do caminho (`/orders`);

- Um pedido s√≥ pode ser criado caso a pessoa usu√°ria esteja logada e o token `JWT` validado;

- Os pedidos enviados devem ser salvos na tabela `Orders` do banco de dados, salvando `id` da pessoa usu√°ria da aplica√ß√£o que fez esse pedido. 

- A tabela `Products` tamb√©m deve ser alterada, atualizando todos os produtos com os `id` inclu√≠dos na chave `productsIds` da requisi√ß√£o, e adicionando nesses produtos o `orderId` do pedido rec√©m criado;

- O endpoint deve receber a seguinte estrutura:
```json
  {
    "productsIds": [1, 2]
  }
```

<details close>
  <summary>Al√©m disso, as seguintes verifica√ß√µes ser√£o feitas:</summary>

  <br>

  > üëâ Para token
  - **[Ser√° validado que n√£o √© poss√≠vel cadastrar pedidos sem token]**
    - Se o token n√£o for informado, o resultado retornado dever√° ser um _status http_ `401` e
    ```json
      { "message": "Token not found" }
    ```

  - **[Ser√° validado que n√£o √© poss√≠vel cadastrar um pedido com token inv√°lido]**
    - Se o token informado n√£o for v√°lido, o resultado retornado dever√° ser um _status http_ `401` e
    ```json
      { "message": "Invalid token" }
    ```

  <br>

  > üëâ Para products
  - **[Ser√° validado que o campo "productsIds" √© obrigat√≥rio]**
    - Se o corpo da requisi√ß√£o n√£o possuir o campo "productsIds", o resultado retornado dever√° ser um _status http_ `400` e
    ```json
      { "message": "\"productsIds\" is required" }
    ```

  - **[Ser√° validado que n√£o √© poss√≠vel criar um pedido com o campo "productsIds" n√£o sendo um array]**
    - Se o valor do campo "productsIds" n√£o for um array, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"productsIds\" must be an array" }
    ```

  - **[Ser√° validado que n√£o √© poss√≠vel cadastrar um pedido se o campo "productsIds" for um array vazio]**
    - Se o campo "productsIds" possuir um array vazio, o resultado retornado dever√° ser um _status http_ `422` e
    ```json
      { "message": "\"productsIds\" must include only numbers" }
    ```

  <br>

  > üëâ Para caso os dados sejam enviados corretamente
  - **[Ser√° validado que √© poss√≠vel criar um pedido com sucesso com 1 item]**
    - O resultado retornado para cadastrar um pedido com sucesso dever√° ser conforme exibido abaixo, com um _status http_ `201`:
    ```json
      {
        "userId": 1,
        "productsIds": [1],
      }
    ```

  - **[Ser√° validado que √© poss√≠vel criar um pedido com sucesso com v√°rios itens]**
    - O resultado retornado para cadastrar um pedido com sucesso dever√° ser conforme exibido abaixo, com um _status http_ `201`:
    ```json
      {
        "userId": 1,
        "productsIds": [1, 2]
      }
    ```
</details>
</details>

---
